<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Taco Boys</title>
    <meta name="theme-color" content="#ffffff" id="theme-color-meta" />
    <meta
      name="msapplication-navbutton-color"
      content="#ffffff"
      id="ms-nav-color-meta"
    />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="default"
      id="apple-status-bar-meta"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --primary-color: #4f46e5;
        --text-color: #333;
        --bg-color: #fff;
        --secondary-bg: #f9fafb;
        --border-color: #e5e7eb;
        --success-color: #10b981;
        --error-color: #ef4444;
        --gallery-bg: #f9fafb;
        --services-bg: #ffffff;
        --services-text: #333333;
        --services-card: #f9fafb;
        --faq-bg: #ffffff;
        --faq-text: #333333;
        --faq-card: #ffffff;
        --contact-bg: #f9fafb;
        --contact-info-text: #333333;
        --contact-info-card: #ffffff;
        --products-bg: #f9fafb;
        --products-text: #333333;
        --products-card: #ffffff;
        --blog-bg: #ffffff;
        --blog-text: #333333;
        --blog-card: #f9fafb;
        --header-height: 70px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        line-height: 1.6;
        color: var(--text-color);
        background-color: var(--bg-color);
        padding-top: var(--header-height);
      }

      /* Header Styles - UPDATED to match body color */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--header-height);
        background-color: var(--bg-color);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border-color);
        z-index: 1000;
        transition: all 0.3s ease;
      }

      .header.scrolled {
        background-color: var(--bg-color);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .header-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .header-logo {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        text-decoration: none;
        color: var(--text-color);
        font-weight: 600;
        font-size: 1.1rem;
        transition: all 0.3s ease;
      }

      .header-logo:hover {
        color: var(--primary-color);
      }

      .header-favicon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid var(--primary-color);
        transition: all 0.3s ease;
      }

      .header-favicon:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 8px rgba(79, 70, 229, 0.3);
      }

      .share-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 45px;
        height: 45px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2rem;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(79, 70, 229, 0.3);
      }

      /* UPDATED: Share button hover uses dynamic primary color */
      .share-button:hover {
        background-color: var(--primary-color);
        filter: brightness(0.9);
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4);
      }

      .share-button:active {
        transform: scale(0.95);
      }

      /* Share Modal Styles */
      .share-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(5px);
      }

      .share-modal.active {
        display: flex;
      }

      .share-modal-content {
        background-color: var(--bg-color);
        border-radius: 1rem;
        padding: 2rem;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        transform: scale(0.9);
        transition: all 0.3s ease;
      }

      .share-modal.active .share-modal-content {
        transform: scale(1);
      }

      .share-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .share-modal-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--text-color);
      }

      .share-modal-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        color: #666;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 50%;
        transition: all 0.3s ease;
      }

      .share-modal-close:hover {
        background-color: var(--secondary-bg);
        color: var(--text-color);
      }

      .share-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .share-option {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem;
        background-color: var(--secondary-bg);
        border-radius: 0.75rem;
        text-decoration: none;
        color: var(--text-color);
        transition: all 0.3s ease;
        cursor: pointer;
        border: none;
        font-family: inherit;
      }

      .share-option:hover {
        background-color: var(--primary-color);
        color: white;
        transform: translateY(-2px);
      }

      .share-option-icon {
        font-size: 1.5rem;
      }

      .share-option-text {
        font-size: 0.8rem;
        font-weight: 500;
      }

      .share-url-container {
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid var(--border-color);
      }

      .share-url-label {
        font-size: 0.9rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
        color: var(--text-color);
      }

      .share-url-input-container {
        display: flex;
        gap: 0.5rem;
      }

      .share-url-input {
        flex: 1;
        padding: 0.75rem;
        border: 1px solid var(--border-color);
        border-radius: 0.5rem;
        font-size: 0.9rem;
        background-color: var(--secondary-bg);
        color: var(--text-color);
      }

      .copy-url-button {
        padding: 0.75rem 1rem;
        background-color: var(--primary-color);
        color: white;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      /* UPDATED: Copy button hover uses dynamic primary color */
      .copy-url-button:hover {
        background-color: var(--primary-color);
        filter: brightness(0.9);
      }

      .copy-url-button.copied {
        background-color: var(--success-color);
      }

      /* Loading Screen Styles */
      .loading-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
      }

      .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
      }

      .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid rgba(79, 70, 229, 0.2);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Main Content Styles */
      .main-content {
        opacity: 0;
        transition: opacity 0.5s ease-in;
      }

      .main-content.loaded {
        opacity: 1;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      header {
        text-align: center;
        margin-bottom: 3rem;
      }

      .profile-image {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        margin-bottom: 1.5rem;
        border: 3px solid var(--primary-color);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      .profile-name {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--text-color);
      }

      .profile-description {
        font-size: 1.1rem;
        max-width: 700px;
        margin: 0 auto 2rem;
        color: #666;
      }

      .section-title {
        font-size: 1.8rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      /* Custom Code Section Styles */
      .custom-code-section {
        padding: 3rem 0;
        margin-bottom: 3rem;
      }

      .services-section {
        padding: 3rem 0;
        background-color: var(--services-bg);
        margin-bottom: 3rem;
      }

      .services-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 2rem;
        margin-bottom: 1rem;
      }

      .service-card {
        background-color: var(--services-card);
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .service-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      .service-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: var(--primary-color);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        font-size: 1.5rem;
      }

      .service-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--services-text);
      }

      .service-description {
        color: var(--services-text);
        font-size: 0.95rem;
      }

      /* Products Section Styles - NEW */
      .products-section {
        padding: 3rem 0;
        background-color: var(--products-bg);
        margin-bottom: 3rem;
      }

      .products-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 2rem;
        margin-bottom: 1rem;
      }

      .product-card {
        background-color: var(--products-card);
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        display: flex;
        flex-direction: column;
      }

      .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      .product-image-container {
        position: relative;
        width: 100%;
        padding-top: 66%; /* 3:2 aspect ratio */
        overflow: hidden;
      }

      .product-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
      }

      .product-card:hover .product-image {
        transform: scale(1.05);
      }

      .product-icon-container {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 180px;
        background-color: rgba(79, 70, 229, 0.1);
      }

      .product-icon {
        font-size: 4rem;
        color: var(--primary-color);
      }

      .product-content {
        padding: 1.5rem;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
      }

      .product-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--products-text);
      }

      .product-description {
        color: var(--products-text);
        font-size: 0.95rem;
        margin-bottom: 1rem;
        flex-grow: 1;
      }

      .product-price {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .product-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background-color: var(--primary-color);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 600;
        text-decoration: none;
        transition: background-color 0.3s ease;
        width: fit-content;
      }

      /* UPDATED: Product link hover uses dynamic primary color */
      .product-link:hover {
        background-color: var(--primary-color);
        filter: brightness(0.9);
      }

      /* Blog Section Styles - NEW */
      .blog-section {
        padding: 3rem 0;
        background-color: var(--blog-bg);
        margin-bottom: 3rem;
      }

      .blog-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 2rem;
        margin-bottom: 1rem;
      }

      .blog-card {
        background-color: var(--blog-card);
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .blog-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      .blog-image-container {
        position: relative;
        width: 100%;
        padding-top: 56.25%; /* 16:9 aspect ratio */
        overflow: hidden;
      }

      .blog-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s ease;
      }

      .blog-card:hover .blog-image {
        transform: scale(1.05);
      }

      .blog-content {
        padding: 1.5rem;
      }

      .blog-date {
        font-size: 0.85rem;
        color: #666;
        margin-bottom: 0.5rem;
      }

      .blog-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: var(--blog-text);
      }

      .blog-excerpt {
        color: var(--blog-text);
        font-size: 0.95rem;
        margin-bottom: 1rem;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .blog-read-more {
        display: inline-flex;
        align-items: center;
        color: var(--primary-color);
        font-weight: 500;
        text-decoration: none;
        transition: opacity 0.3s ease;
      }

      .blog-read-more:hover {
        opacity: 0.8;
      }

      .blog-read-more i {
        margin-left: 0.25rem;
        font-size: 0.85rem;
      }

      /* Enhanced Professional Block Styles */
      .blocks-section {
        margin-bottom: 0;
      }

      .block-section {
        padding: 4rem 0;
        margin-bottom: 0;
        position: relative;
        overflow: hidden;
      }

      /* Block Layout Styles */
      .block-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
      }

      .block-two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4rem;
        align-items: center;
        min-height: 500px;
      }

      .block-two-column.image-left {
        grid-template-areas: "image content";
      }

      .block-two-column.image-right {
        grid-template-areas: "content image";
      }

      .block-content-area {
        grid-area: content;
        padding: 2rem 0;
      }

      .block-image-area {
        grid-area: image;
        position: relative;
      }

      .block-centered {
        text-align: center;
        max-width: 900px;
        margin: 0 auto;
        padding: 3rem 2rem;
      }

      .block-hero {
        min-height: 70vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        position: relative;
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
      }

      .block-hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.4);
        z-index: 1;
      }

      .block-hero .block-content-area {
        position: relative;
        z-index: 2;
        color: white;
        max-width: 800px;
        padding: 0 2rem;
      }

      .block-feature-highlight {
        background: linear-gradient(
          135deg,
          rgba(79, 70, 229, 0.1),
          rgba(79, 70, 229, 0.05)
        );
        border-radius: 2rem;
        padding: 4rem 3rem;
        text-align: center;
        border: 1px solid rgba(79, 70, 229, 0.2);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      }

      .block-card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 3rem;
        align-items: start;
      }

      .block-card {
        background: var(--bg-color);
        border-radius: 1.5rem;
        padding: 3rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: 1px solid rgba(0, 0, 0, 0.05);
      }

      .block-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      }

      /* Typography Styles */
      .block-subtitle {
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--primary-color);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 1rem;
        opacity: 0.9;
      }

      .block-title {
        font-size: 2.5rem;
        font-weight: 700;
        line-height: 1.2;
        margin-bottom: 1.5rem;
        color: inherit;
      }

      .block-hero .block-title {
        font-size: 3.5rem;
        margin-bottom: 2rem;
      }

      .block-centered .block-title,
      .block-feature-highlight .block-title {
        font-size: 2.8rem;
      }

      .block-description {
        font-size: 1.1rem;
        line-height: 1.7;
        margin-bottom: 2.5rem;
        color: inherit;
        opacity: 0.8;
      }

      .block-hero .block-description {
        font-size: 1.3rem;
        margin-bottom: 3rem;
      }

      /* Button Styles */
      .block-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 1rem 2.5rem;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        border-radius: 0.75rem;
        transition: all 0.3s ease;
        cursor: pointer;
        border: 2px solid transparent;
        min-width: 140px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .block-button-primary {
        background-color: var(--primary-color);
        color: white;
        box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
      }

      .block-button-primary:hover {
        background-color: var(--primary-color);
        filter: brightness(0.9);
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(79, 70, 229, 0.4);
      }

      .block-button-secondary {
        background-color: transparent;
        color: var(--primary-color);
        border-color: var(--primary-color);
        box-shadow: 0 4px 15px rgba(79, 70, 229, 0.2);
      }

      .block-button-secondary:hover {
        background-color: var(--primary-color);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
      }

      .block-button-ghost {
        background-color: transparent;
        color: var(--primary-color);
        border: none;
        text-decoration: underline;
        text-underline-offset: 6px;
        text-decoration-thickness: 2px;
      }

      .block-button-ghost:hover {
        opacity: 0.8;
        text-decoration: none;
        transform: translateY(-2px);
      }

      /* Image Styles */
      .block-image-container {
        position: relative;
        width: 100%;
        height: 100%;
        min-height: 400px;
        border-radius: 1.5rem;
        overflow: hidden;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }

      .block-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
      }

      .block-image-container:hover .block-image {
        transform: scale(1.05);
      }

      .block-centered .block-image-container,
      .block-feature-highlight .block-image-container {
        max-width: 500px;
        margin: 2rem auto 0;
      }

      /* Color Schemes */
      .block-scheme-light {
        background-color: #ffffff;
        color: #333333;
      }

      .block-scheme-dark {
        background-color: #1a1a1a;
        color: #ffffff;
      }

      .block-scheme-dark .block-button-primary {
        background-color: #ffffff;
        color: #1a1a1a;
        box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);
      }

      .block-scheme-dark .block-button-secondary {
        border-color: #ffffff;
        color: #ffffff;
      }

      .block-scheme-dark .block-button-secondary:hover {
        background-color: #ffffff;
        color: #1a1a1a;
      }

      /* Spacing Options */
      .block-padding-none {
        padding: 0;
      }
      .block-padding-small {
        padding: 2rem 0;
      }
      .block-padding-normal {
        padding: 4rem 0;
      }
      .block-padding-large {
        padding: 6rem 0;
      }

      /* Animation Styles */
      .block-animate {
        opacity: 0;
        transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .block-animate.animate-in {
        opacity: 1;
      }

      .block-fade-in:not(.animate-in) {
        transform: translateY(30px);
      }

      .block-slide-up:not(.animate-in) {
        transform: translateY(60px);
      }

      .block-slide-left:not(.animate-in) {
        transform: translateX(-60px);
      }

      .block-slide-right:not(.animate-in) {
        transform: translateX(60px);
      }

      .gallery-section {
        padding: 3rem 0;
        background-color: var(--gallery-bg);
        margin-bottom: 3rem;
      }

      .gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 1rem;
      }

      .gallery-item {
        position: relative;
        border-radius: 0.5rem;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        transition: transform 0.3s ease;
        aspect-ratio: 3/2;
      }

      .gallery-item:hover {
        transform: translateY(-5px);
      }

      .gallery-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .links-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1rem;
        margin: 2rem auto;
        max-width: 600px;
      }

      .social-link {
        display: flex;
        align-items: center;
        padding: 0.5rem 1rem;
        background-color: var(--secondary-bg);
        color: var(--text-color);
        border-radius: 0.5rem;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .social-link:hover {
        background-color: var(--primary-color);
        color: white;
      }

      .social-link i {
        margin-right: 0.5rem;
      }

      /* UPDATED: Contact Section Styles to match the image */
      .contact-section {
        padding: 3rem 0;
        margin-bottom: 3rem;
        background-color: var(--contact-bg);
      }

      .contact-form {
        max-width: 600px;
        margin: 0 auto;
        background-color: var(--bg-color);
        padding: 2.5rem;
        border-radius: 1rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      }

      /* Contact form title with icon */
      .contact-form-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.75rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 2rem;
      }

      .contact-form-icon {
        color: var(--primary-color);
        font-size: 1.5rem;
      }

      .form-group {
        margin-bottom: 1.75rem;
      }

      .form-label {
        display: block;
        margin-bottom: 0.75rem;
        font-weight: 500;
        color: var(--text-color);
        font-size: 1rem;
      }

      .form-input,
      .form-textarea {
        width: 100%;
        padding: 1rem 1.25rem;
        border: 2px solid var(--border-color);
        border-radius: 0.75rem;
        font-size: 1rem;
        font-family: inherit;
        transition: all 0.3s ease;
        background-color: var(--secondary-bg);
        color: var(--text-color);
      }

      .form-input::placeholder,
      .form-textarea::placeholder {
        color: #9ca3af;
      }

      .form-textarea {
        min-height: 140px;
        resize: vertical;
      }

      .form-input:focus,
      .form-textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        background-color: var(--bg-color);
      }

      .submit-button {
        width: 100%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background-color: var(--primary-color);
        color: white;
        padding: 1rem 2rem;
        border-radius: 0.75rem;
        font-weight: 600;
        font-size: 1rem;
        text-decoration: none;
        border: none;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
      }

      /* UPDATED: Submit button hover uses dynamic primary color */
      .submit-button:hover {
        background-color: var(--primary-color);
        filter: brightness(0.9);
        transform: translateY(-1px);
        box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4);
      }

      .submit-button:disabled {
        background-color: #9ca3af;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
        filter: none;
      }

      .loading {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 1s ease-in-out infinite;
        margin-right: 0.5rem;
      }

      .alert {
        padding: 1rem;
        border-radius: 0.75rem;
        margin-bottom: 1.5rem;
        display: none;
        font-weight: 500;
      }

      .alert-success {
        background-color: rgba(16, 185, 129, 0.1);
        color: var(--success-color);
        border: 1px solid rgba(16, 185, 129, 0.3);
      }

      .alert-error {
        background-color: rgba(239, 68, 68, 0.1);
        color: var(--error-color);
        border: 1px solid rgba(239, 68, 68, 0.3);
      }

      /* Enhanced Modal Styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.95);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        position: relative;
        max-width: 95%;
        max-height: 95%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-image {
        max-width: 100%;
        max-height: 90vh;
        object-fit: contain;
        border-radius: 8px;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
      }

      .modal-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background-color: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 1.5rem;
        color: #333;
        transition: all 0.3s ease;
        z-index: 1001;
      }

      .modal-nav:hover {
        background-color: white;
        transform: translateY(-50%) scale(1.1);
      }

      .modal-nav:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: translateY(-50%) scale(1);
      }

      .modal-nav.prev {
        left: 20px;
      }

      .modal-nav.next {
        right: 20px;
      }

      .close-modal {
        position: absolute;
        top: 20px;
        right: 20px;
        background-color: rgba(255, 255, 255, 0.9);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 1.5rem;
        color: #333;
        transition: all 0.3s ease;
        z-index: 1001;
      }

      .close-modal:hover {
        background-color: white;
        transform: scale(1.1);
      }

      .modal-counter {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
        z-index: 1001;
      }

      .modal-title {
        position: absolute;
        top: 20px;
        left: 20px;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9rem;
        max-width: calc(100% - 120px);
        z-index: 1001;
      }

      .info-section {
        padding: 3rem 0;
        margin-bottom: 3rem;
        background-color: var(--secondary-bg);
      }

      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 2rem;
      }

      /* UPDATED: Contact Information cards with hover animation like services */
      .info-card {
        background-color: var(--contact-info-card);
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      }

      /* Asegurar que los enlaces mantengan su color en hover del card */
      .info-card:hover .info-content a {
        color: var(--primary-color);
      }

      .info-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: var(--primary-color);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        font-size: 1.5rem;
      }

      .info-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--contact-info-text);
      }

      .info-content {
        color: var(--contact-info-text);
      }

      /* NUEVO: Estilos para enlaces en contact information */
      .info-content a {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
        transition: opacity 0.3s ease;
      }

      .info-content a:hover {
        opacity: 0.8;
        color: var(--primary-color); /* Mantiene el color del perfil */
      }

      .info-content a:visited {
        color: var(--primary-color); /* Mantiene el color despu√©s de visitado */
      }

      .info-content a:focus {
        color: var(--primary-color);
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
        border-radius: 2px;
      }

      .faq-section {
        padding: 3rem 0;
        margin-bottom: 3rem;
        background-color: var(--faq-bg);
      }

      .faq-container {
        max-width: 800px;
        margin: 0 auto;
      }

      .faq-item {
        margin-bottom: 1.5rem;
        border: 1px solid var(--border-color);
        border-radius: 0.75rem;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .faq-question {
        padding: 1.25rem;
        background-color: var(--faq-card);
        font-weight: 600;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .faq-question:hover {
        background-color: rgba(79, 70, 229, 0.05);
      }

      .faq-answer {
        padding: 0;
        max-height: 0;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .faq-answer-content {
        padding: 0 1.25rem 1.25rem;
        color: var(--faq-text);
      }

      .faq-item.active {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }

      .faq-item.active .faq-answer {
        max-height: 1000px;
        transition: max-height 0.5s ease;
      }

      .footer {
        text-align: center;
        margin-top: 4rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border-color);
        color: #666;
        font-size: 0.9rem;
      }

      .hidden {
        display: none !important;
      }

      /* Confirmation Modal Styles - NEW */
      .confirm-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(5px);
      }

      .confirm-modal.active {
        display: flex;
      }

      .confirm-modal-content {
        background-color: var(--bg-color);
        border-radius: 1rem;
        padding: 2rem;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        text-align: center;
      }

      .confirm-modal-icon {
        font-size: 3rem;
        color: var(--error-color);
        margin-bottom: 1rem;
      }

      .confirm-modal-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1rem;
      }

      .confirm-modal-message {
        color: #666;
        margin-bottom: 1.5rem;
      }

      .confirm-modal-buttons {
        display: flex;
        justify-content: center;
        gap: 1rem;
      }

      .confirm-modal-button {
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
      }

      .confirm-modal-cancel {
        background-color: #e5e7eb;
        color: #4b5563;
      }

      .confirm-modal-cancel:hover {
        background-color: #d1d5db;
      }

      .confirm-modal-confirm {
        background-color: var(--error-color);
        color: white;
      }

      .confirm-modal-confirm:hover {
        background-color: #dc2626;
      }

      /* Blog Post Modal Styles - NEW */
      .blog-post-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(5px);
      }

      .blog-post-modal.active {
        display: flex;
      }

      .blog-post-modal-content {
        background-color: var(--bg-color);
        border-radius: 1rem;
        padding: 2rem;
        max-width: 800px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
      }

      .blog-post-modal-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1.5rem;
      }

      .blog-post-modal-title {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--text-color);
      }

      .blog-post-modal-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        color: #666;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 50%;
        transition: all 0.3s ease;
      }

      .blog-post-modal-close:hover {
        background-color: var(--secondary-bg);
        color: var(--text-color);
      }

      .blog-post-modal-date {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 1rem;
      }

      .blog-post-modal-image {
        width: 100%;
        max-height: 400px;
        object-fit: cover;
        border-radius: 0.75rem;
        margin-bottom: 1.5rem;
      }

      .blog-post-modal-content p {
        margin-bottom: 1rem;
        line-height: 1.7;
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .block-container {
          padding: 0 1.5rem;
        }

        .block-two-column {
          gap: 3rem;
        }

        .block-title {
          font-size: 2.2rem;
        }

        .block-hero .block-title {
          font-size: 3rem;
        }
      }

      @media (max-width: 768px) {
        .header-container {
          padding: 0 1rem;
        }

        .header-favicon {
          width: 35px;
          height: 35px;
        }

        .share-button {
          width: 40px;
          height: 40px;
          font-size: 1.1rem;
        }

        .share-modal-content {
          padding: 1.5rem;
        }

        .share-options {
          grid-template-columns: repeat(3, 1fr);
        }

        .container {
          padding: 1rem;
        }

        .profile-name {
          font-size: 2rem;
        }

        .services-grid {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .products-grid {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .blog-grid {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .gallery {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
          gap: 1rem;
        }

        .info-grid {
          grid-template-columns: 1fr;
        }

        .modal-nav {
          width: 40px;
          height: 40px;
          font-size: 1.2rem;
        }

        .modal-nav.prev {
          left: 10px;
        }

        .modal-nav.next {
          right: 10px;
        }

        .close-modal {
          top: 10px;
          right: 10px;
          width: 40px;
          height: 40px;
          font-size: 1.2rem;
        }

        .modal-title {
          top: 10px;
          left: 10px;
          font-size: 0.8rem;
          max-width: calc(100% - 80px);
        }

        .modal-counter {
          bottom: 10px;
          font-size: 0.8rem;
        }

        .blog-post-modal-content {
          padding: 1.5rem;
        }

        .blog-post-modal-title {
          font-size: 1.5rem;
        }

        /* Contact form responsive */
        .contact-form {
          padding: 2rem;
        }

        .contact-form-title {
          font-size: 1.5rem;
        }

        /* Block responsive styles */
        .block-two-column {
          grid-template-columns: 1fr;
          grid-template-areas:
            "content"
            "image" !important;
          gap: 2rem;
          min-height: auto;
        }

        .block-content-area {
          padding: 1rem 0;
          text-align: center;
        }

        .block-image-container {
          min-height: 300px;
        }

        .block-title {
          font-size: 1.8rem;
        }

        .block-hero .block-title {
          font-size: 2.5rem;
        }

        .block-centered .block-title,
        .block-feature-highlight .block-title {
          font-size: 2rem;
        }

        .block-hero {
          min-height: 60vh;
        }

        .block-feature-highlight,
        .block-card {
          padding: 2rem;
        }

        .block-card-grid {
          grid-template-columns: 1fr;
          gap: 2rem;
        }

        .block-container {
          padding: 0 1rem;
        }
      }

      @media (max-width: 480px) {
        .block-section {
          padding: 3rem 0;
        }

        .block-title {
          font-size: 1.6rem;
        }

        .block-description {
          font-size: 1rem;
        }

        .block-button {
          padding: 0.875rem 2rem;
          font-size: 0.9rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <div class="header" id="header">
      <div class="header-container">
        <a href="#" class="header-logo" id="header-logo">
          <img
            src="/images/profile.jpg"
            alt="Favicon"
            class="header-favicon"
            id="header-favicon"
          />
          <span id="header-name">Profile</span>
        </a>

        <button
          class="share-button"
          id="share-button"
          title="Share this profile"
        >
          <i class="fas fa-share-alt"></i>
        </button>
      </div>
    </div>

    <!-- Share Modal -->
    <div class="share-modal" id="share-modal">
      <div class="share-modal-content">
        <div class="share-modal-header">
          <h3 class="share-modal-title">Share Profile</h3>
          <button class="share-modal-close" id="share-modal-close">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="share-options">
          <button
            class="share-option"
            id="share-native"
            title="Share via device"
          >
            <i class="fas fa-share-alt share-option-icon"></i>
            <span class="share-option-text">Share</span>
          </button>

          <a
            class="share-option"
            id="share-twitter"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fab fa-twitter share-option-icon"></i>
            <span class="share-option-text">Twitter</span>
          </a>

          <a
            class="share-option"
            id="share-facebook"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fab fa-facebook-f share-option-icon"></i>
            <span class="share-option-text">Facebook</span>
          </a>

          <a
            class="share-option"
            id="share-linkedin"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fab fa-linkedin-in share-option-icon"></i>
            <span class="share-option-text">LinkedIn</span>
          </a>

          <a
            class="share-option"
            id="share-whatsapp"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fab fa-whatsapp share-option-icon"></i>
            <span class="share-option-text">WhatsApp</span>
          </a>

          <a
            class="share-option"
            id="share-telegram"
            target="_blank"
            rel="noopener noreferrer"
          >
            <i class="fab fa-telegram-plane share-option-icon"></i>
            <span class="share-option-text">Telegram</span>
          </a>
        </div>

        <div class="share-url-container">
          <div class="share-url-label">Copy Link</div>
          <div class="share-url-input-container">
            <input
              type="text"
              class="share-url-input"
              id="share-url-input"
              readonly
            />
            <button class="copy-url-button" id="copy-url-button">Copy</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
      <div class="loading-spinner"></div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="main-content">
      <div class="container">
        <header>
          <img
            src="/images/profile.jpg"
            alt="Profile"
            class="profile-image"
            id="profile-image"
          />
          <h1 class="profile-name" id="profile-name">John Doe</h1>
          <p class="profile-description" id="profile-description">
            Welcome to my personal profile! I'm a passionate web developer with
            expertise in creating responsive and user-friendly websites. Feel
            free to browse through my work and get in touch if you'd like to
            collaborate.
          </p>
        </header>

        <div class="links-container" id="links-container">
          <!-- Social links will be loaded dynamically -->
        </div>

        <!-- FIXED: Changed to section with proper ID -->
        <section id="blocks-container" class="blocks-section">
          <!-- Blocks will be inserted dynamically -->
        </section>

        <section id="services-section" class="services-section">
          <div class="container">
            <h2 class="section-title" id="services-title">My Services</h2>
            <div class="services-grid" id="services-grid">
              <!-- Services will be loaded dynamically -->
            </div>
          </div>
        </section>

        <!-- NEW: Products Section -->
        <section id="products-section" class="products-section">
          <div class="container">
            <h2 class="section-title" id="products-title">My Products</h2>
            <div class="products-grid" id="products-grid">
              <!-- Products will be loaded dynamically -->
            </div>
          </div>
        </section>

        <section id="gallery-section" class="gallery-section">
          <div class="container">
            <h2 class="section-title" id="gallery-title">My Gallery</h2>
            <div class="gallery" id="gallery">
              <!-- Gallery images will be loaded dynamically -->
            </div>
          </div>
        </section>

        <!-- NEW: Blog Section -->
        <section id="blog-section" class="blog-section">
          <div class="container">
            <h2 class="section-title" id="blog-title">Latest Blog Posts</h2>
            <div class="blog-grid" id="blog-grid">
              <!-- Blog posts will be loaded dynamically -->
            </div>
          </div>
        </section>

        <section id="faq-section" class="faq-section">
          <div class="container">
            <h2 class="section-title" id="faq-title">
              Frequently Asked Questions
            </h2>
            <div class="faq-container" id="faq-container">
              <!-- FAQs will be loaded dynamically -->
            </div>
          </div>
        </section>

        <section id="info-section" class="info-section">
          <div class="container">
            <h2 class="section-title" id="info-title">Contact Information</h2>
            <div class="info-grid" id="info-grid">
              <!-- Contact info will be loaded dynamically -->
            </div>
          </div>
        </section>

        <!-- UPDATED: Contact Section with improved styling -->
        <section id="contact-section" class="contact-section">
          <div class="container">
            <h2 class="section-title" id="contact-title">Contact Me</h2>
            <div class="contact-form">
              <!-- Contact form title with icon -->
              <h3 class="contact-form-title">
                <i class="fas fa-envelope contact-form-icon"></i>
                Send Message
              </h3>

              <div class="alert alert-success" id="success-alert">
                Your message has been sent successfully! I'll get back to you
                soon.
              </div>
              <div class="alert alert-error" id="error-alert">
                There was an error sending your message. Please try again.
              </div>
              <form id="contact-form">
                <div class="form-group">
                  <label for="name" class="form-label">Full Name *</label>
                  <input
                    type="text"
                    id="name"
                    name="name"
                    class="form-input"
                    placeholder="Enter your full name"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="email" class="form-label">Email Address *</label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    class="form-input"
                    placeholder="Enter your email address"
                    required
                  />
                </div>
                <div class="form-group">
                  <label for="message" class="form-label">Message *</label>
                  <textarea
                    id="message"
                    name="message"
                    class="form-textarea"
                    placeholder="Enter your message here..."
                    required
                  ></textarea>
                </div>
                <button type="submit" class="submit-button" id="submit-button">
                  <span id="loading" class="loading hidden"></span>
                  <span id="button-text">Send Message</span>
                </button>
              </form>
            </div>
          </div>
        </section>

        <!-- NEW: Custom Code Section - PROPERLY POSITIONED -->
        <section id="custom-code-section" class="custom-code-section">
          <div class="container">
            <div id="custom-code-placeholder">
              <!-- Custom code will be injected here -->
            </div>
          </div>
        </section>
      </div>

      <!-- Enhanced Modal -->
      <div class="modal" id="image-modal">
        <div class="modal-title" id="modal-title">Gallery Image</div>
        <button class="close-modal" id="close-modal">
          <i class="fas fa-times"></i>
        </button>
        <button class="modal-nav prev" id="prev-image">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button class="modal-nav next" id="next-image">
          <i class="fas fa-chevron-right"></i>
        </button>
        <div class="modal-content">
          <img
            src="/placeholder.svg"
            alt="Gallery Image"
            class="modal-image"
            id="modal-image"
          />
        </div>
        <div class="modal-counter" id="modal-counter">1 / 1</div>
      </div>

      <!-- NEW: Blog Post Modal -->
      <div class="blog-post-modal" id="blog-post-modal">
        <div class="blog-post-modal-content">
          <div class="blog-post-modal-header">
            <h2 class="blog-post-modal-title" id="blog-post-modal-title">
              Blog Post Title
            </h2>
            <button class="blog-post-modal-close" id="blog-post-modal-close">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="blog-post-modal-date" id="blog-post-modal-date">
            January 1, 2023
          </div>
          <img
            src="/placeholder.svg"
            alt="Blog Post"
            class="blog-post-modal-image"
            id="blog-post-modal-image"
          />
          <div id="blog-post-modal-body">
            <!-- Blog post content will be loaded dynamically -->
          </div>
        </div>
      </div>

      <!-- NEW: Confirmation Modal -->
      <div class="confirm-modal" id="confirm-modal">
        <div class="confirm-modal-content">
          <div class="confirm-modal-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <h3 class="confirm-modal-title" id="confirm-modal-title">
            Confirm Action
          </h3>
          <p class="confirm-modal-message" id="confirm-modal-message">
            Are you sure you want to proceed with this action?
          </p>
          <div class="confirm-modal-buttons">
            <button
              class="confirm-modal-button confirm-modal-cancel"
              id="confirm-modal-cancel"
            >
              Cancel
            </button>
            <button
              class="confirm-modal-button confirm-modal-confirm"
              id="confirm-modal-confirm"
            >
              Confirm
            </button>
          </div>
        </div>
      </div>

      <footer class="footer">
        <p>
          &copy; <span id="current-year"></span>
          <span id="footer-name">Custom Web Profile</span>. All rights reserved.
        </p>
      </footer>
    </div>

    <script>
      // Loading management
      let isDataLoaded = false;
      let isImagesLoaded = false;
      let galleryImages = [];
      let currentImageIndex = 0;
      let profileData = {};
      let blogPosts = [];
      let products = [];

      // Set current year in footer
      document.getElementById("current-year").textContent =
        new Date().getFullYear();

      // Header scroll effect
      window.addEventListener("scroll", () => {
        const header = document.getElementById("header");
        if (window.scrollY > 50) {
          header.classList.add("scrolled");
        } else {
          header.classList.remove("scrolled");
        }
      });

      // Share functionality
      const shareButton = document.getElementById("share-button");
      const shareModal = document.getElementById("share-modal");
      const shareModalClose = document.getElementById("share-modal-close");
      const shareUrlInput = document.getElementById("share-url-input");
      const copyUrlButton = document.getElementById("copy-url-button");

      // Share button click
      shareButton.addEventListener("click", () => {
        openShareModal();
      });

      // Close share modal
      shareModalClose.addEventListener("click", () => {
        closeShareModal();
      });

      // Close modal when clicking outside
      shareModal.addEventListener("click", (e) => {
        if (e.target === shareModal) {
          closeShareModal();
        }
      });

      // ESC key to close modal
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && shareModal.classList.contains("active")) {
          closeShareModal();
        }
      });

      function openShareModal() {
        const currentUrl = window.location.href;
        const title = profileData.name
          ? `${profileData.name} - Profile`
          : "Check out this profile";
        const description =
          profileData.description || "Amazing profile to check out!";

        // Set URL in input
        shareUrlInput.value = currentUrl;

        // Update share links
        updateShareLinks(currentUrl, title, description);

        // Show modal
        shareModal.classList.add("active");
        document.body.style.overflow = "hidden";
      }

      function closeShareModal() {
        shareModal.classList.remove("active");
        document.body.style.overflow = "auto";

        // Reset copy button
        copyUrlButton.textContent = "Copy";
        copyUrlButton.classList.remove("copied");
      }

      function updateShareLinks(url, title, description) {
        const encodedUrl = encodeURIComponent(url);
        const encodedTitle = encodeURIComponent(title);
        const encodedDescription = encodeURIComponent(description);

        // Twitter
        document.getElementById(
          "share-twitter"
        ).href = `https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}`;

        // Facebook - FIXED
        document.getElementById(
          "share-facebook"
        ).href = `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}&quote=${encodedTitle}`;

        // LinkedIn
        document.getElementById(
          "share-linkedin"
        ).href = `https://www.linkedin.com/sharing/share-offsite/?url=${encodedUrl}`;

        // WhatsApp
        document.getElementById(
          "share-whatsapp"
        ).href = `https://wa.me/?text=${encodedTitle}%20${encodedUrl}`;

        // Telegram
        document.getElementById(
          "share-telegram"
        ).href = `https://t.me/share/url?url=${encodedUrl}&text=${encodedTitle}`;
      }

      // Native share API
      document
        .getElementById("share-native")
        .addEventListener("click", async () => {
          if (navigator.share) {
            try {
              await navigator.share({
                title: profileData.name
                  ? `${profileData.name} - Profile`
                  : "Check out this profile",
                text:
                  profileData.description || "Amazing profile to check out!",
                url: window.location.href,
              });
              closeShareModal();
            } catch (error) {
              console.log("Error sharing:", error);
              // Fallback to copy URL
              copyToClipboard();
            }
          } else {
            // Fallback to copy URL
            copyToClipboard();
          }
        });

      // Copy URL functionality
      copyUrlButton.addEventListener("click", () => {
        copyToClipboard();
      });

      async function copyToClipboard() {
        try {
          await navigator.clipboard.writeText(shareUrlInput.value);
          copyUrlButton.textContent = "Copied!";
          copyUrlButton.classList.add("copied");

          setTimeout(() => {
            copyUrlButton.textContent = "Copy";
            copyUrlButton.classList.remove("copied");
          }, 2000);
        } catch (error) {
          // Fallback for older browsers
          shareUrlInput.select();
          document.execCommand("copy");
          copyUrlButton.textContent = "Copied!";
          copyUrlButton.classList.add("copied");

          setTimeout(() => {
            copyUrlButton.textContent = "Copy";
            copyUrlButton.classList.remove("copied");
          }, 2000);
        }
      }

      // Hide loading screen when everything is ready
      function hideLoadingScreen() {
        if (isDataLoaded && isImagesLoaded) {
          const loadingScreen = document.getElementById("loading-screen");
          const mainContent = document.getElementById("main-content");

          setTimeout(() => {
            loadingScreen.classList.add("hidden");
            mainContent.classList.add("loaded");
          }, 300);
        }
      }

      // Check if all images are loaded
      function checkImagesLoaded() {
        const images = document.querySelectorAll("img");
        let loadedCount = 0;

        if (images.length === 0) {
          isImagesLoaded = true;
          hideLoadingScreen();
          return;
        }

        images.forEach((img) => {
          if (img.complete) {
            loadedCount++;
          } else {
            img.addEventListener("load", () => {
              loadedCount++;
              if (loadedCount === images.length) {
                isImagesLoaded = true;
                hideLoadingScreen();
              }
            });

            img.addEventListener("error", () => {
              loadedCount++;
              if (loadedCount === images.length) {
                isImagesLoaded = true;
                hideLoadingScreen();
              }
            });
          }
        });

        if (loadedCount === images.length) {
          isImagesLoaded = true;
          hideLoadingScreen();
        }
      }

      // Update meta tags for social sharing
      function updateMetaTags(data) {
        // Remove existing meta tags
        const existingMetas = document.querySelectorAll(
          'meta[property^="og:"], meta[name="twitter:"], meta[name="description"]'
        );
        existingMetas.forEach((meta) => meta.remove());

        // Add new meta tags
        const metaTags = [
          { name: "description", content: data.description },
          { property: "og:title", content: `${data.name} - Profile` },
          { property: "og:description", content: data.description },
          {
            property: "og:image",
            content: window.location.origin + data.profileImage,
          },
          { property: "og:url", content: window.location.href },
          { property: "og:type", content: "profile" },
          { property: "og:site_name", content: data.name },
          { name: "twitter:card", content: "summary_large_image" },
          { name: "twitter:title", content: `${data.name} - Profile` },
          { name: "twitter:description", content: data.description },
          {
            name: "twitter:image",
            content: window.location.origin + data.profileImage,
          },
        ];

        metaTags.forEach((tag) => {
          const meta = document.createElement("meta");
          if (tag.name) meta.name = tag.name;
          if (tag.property) meta.property = tag.property;
          meta.content = tag.content;
          document.head.appendChild(meta);
        });
      }

      // UPDATED: Function to update status bar color
      function updateStatusBarColor(bgColor) {
        // Update theme-color meta tag
        const themeColorMeta = document.getElementById("theme-color-meta");
        if (themeColorMeta) {
          themeColorMeta.content = bgColor;
        }

        // Update MS navigation button color
        const msNavColorMeta = document.getElementById("ms-nav-color-meta");
        if (msNavColorMeta) {
          msNavColorMeta.content = bgColor;
        }

        // Update Apple status bar style based on background color
        const appleStatusBarMeta = document.getElementById(
          "apple-status-bar-meta"
        );
        if (appleStatusBarMeta) {
          // Determine if background is light or dark
          const isLightBackground = isLightColor(bgColor);
          appleStatusBarMeta.content = isLightBackground
            ? "default"
            : "black-translucent";
        }
      }

      // Helper function to determine if a color is light or dark
      function isLightColor(color) {
        // Convert hex to RGB
        const hex = color.replace("#", "");
        const r = parseInt(hex.substr(0, 2), 16);
        const g = parseInt(hex.substr(2, 2), 16);
        const b = parseInt(hex.substr(4, 2), 16);

        // Calculate luminance
        const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;

        // Return true if light (luminance > 0.5)
        return luminance > 0.5;
      }

      // Fetch profile data
      async function fetchProfileData() {
        try {
          const response = await fetch("/api/profile");
          if (!response.ok) {
            throw new Error("Failed to fetch profile data");
          }

          const data = await response.json();
          profileData = data; // Store for share functionality

          // Apply theme colors
          document.documentElement.style.setProperty(
            "--bg-color",
            data.backgroundColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--text-color",
            data.textColor || "#333333"
          );
          document.documentElement.style.setProperty(
            "--primary-color",
            data.accentColor || "#4f46e5"
          );
          document.documentElement.style.setProperty(
            "--gallery-bg",
            data.galleryBgColor || "#f9fafb"
          );
          document.documentElement.style.setProperty(
            "--services-bg",
            data.servicesBgColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--services-text",
            data.servicesTextColor || "#333333"
          );
          document.documentElement.style.setProperty(
            "--services-card",
            data.servicesCardColor || "#f9fafb"
          );
          document.documentElement.style.setProperty(
            "--faq-bg",
            data.faqBgColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--faq-text",
            data.faqTextColor || "#333333"
          );
          document.documentElement.style.setProperty(
            "--faq-card",
            data.faqCardColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--contact-bg",
            data.contactBgColor || "#f9fafb"
          );
          document.documentElement.style.setProperty(
            "--contact-info-text",
            data.contactInfoTextColor || "#333333"
          );
          document.documentElement.style.setProperty(
            "--contact-info-card",
            data.contactInfoCardColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--products-bg",
            data.productsBgColor || "#f9fafb"
          );
          document.documentElement.style.setProperty(
            "--products-text",
            data.productsTextColor || "#333333"
          );
          document.documentElement.style.setProperty(
            "--products-card",
            data.productsCardColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--blog-bg",
            data.blogBgColor || "#ffffff"
          );
          document.documentElement.style.setProperty(
            "--blog-text",
            data.blogTextColor || "#333333"
          );
          document.documentElement.style.setProperty(
            "--blog-card",
            data.blogCardColor || "#f9fafb"
          );

          // UPDATED: Update status bar color to match body background
          updateStatusBarColor(data.backgroundColor || "#ffffff");

          // Update header
          document.getElementById("header-name").textContent = data.name;
          document.getElementById("header-favicon").src =
            data.logoImage || data.profileImage;

          // Update profile information
          document.getElementById("profile-name").textContent = data.name;
          document.getElementById("profile-description").textContent =
            data.description;
          document.getElementById("profile-image").src = data.profileImage;

          // Update section titles
          if (data.servicesSectionTitle) {
            document.getElementById("services-title").textContent =
              data.servicesSectionTitle;
          }

          if (data.gallerySectionTitle) {
            document.getElementById("gallery-title").textContent =
              data.gallerySectionTitle;
          }

          if (data.contactSectionTitle) {
            document.getElementById("contact-title").textContent =
              data.contactSectionTitle;
          }

          if (data.infoSectionTitle) {
            document.getElementById("info-title").textContent =
              data.infoSectionTitle;
          }

          if (data.faqSectionTitle) {
            document.getElementById("faq-title").textContent =
              data.faqSectionTitle;
          }

          if (data.productsSectionTitle) {
            document.getElementById("products-title").textContent =
              data.productsSectionTitle;
          }

          if (data.blogSectionTitle) {
            document.getElementById("blog-title").textContent =
              data.blogSectionTitle;
          }

          // Update footer name
          document.getElementById("footer-name").textContent = data.name;

          // Set favicon
          const favicon = document.createElement("link");
          favicon.rel = "icon";
          favicon.href = data.logoImage || data.profileImage;
          document.head.appendChild(favicon);

          // Update page title and meta tags
          document.title = `${data.name} - Profile`;
          updateMetaTags(data);

          // Store gallery images for modal navigation
          galleryImages = data.galleryImages || [];

          // Store blog posts and products
          blogPosts = data.blogPosts || [];
          products = data.products || [];

          // Load social links
          loadSocialLinks(data.links || []);

          // Load services
          loadServices(data.services || []);

          // Load products
          loadProducts(data.products || []);

          // Load gallery images
          loadGalleryImages(data.galleryImages || []);

          // Load blog posts
          loadBlogPosts(data.blogPosts || []);

          // Load blocks with enhanced professional system
          loadBlocks(data.blocks || []);

          // Load contact information
          loadContactInfo(data.contactInfo || []);

          // Load FAQs
          loadFaqs(data.faqs || []);

          // FIXED: Reorder sections if order provided
          if (data.sectionOrder && data.sectionOrder.length > 0) {
            reorderSections(data.sectionOrder);
          }

          // UPDATED: Inject custom code if provided - now in proper section
          if (data.customCode) {
            const placeholder = document.getElementById(
              "custom-code-placeholder"
            );
            if (placeholder) {
              placeholder.innerHTML = data.customCode;
            }
          }

          // FIXED: Show/hide sections based on content - COMPREHENSIVE CHECK
          // Hide services section if no services
          if (!data.services || data.services.length === 0) {
            document.getElementById("services-section").classList.add("hidden");
          } else {
            document
              .getElementById("services-section")
              .classList.remove("hidden");
          }

          // Hide products section if no products
          if (!data.products || data.products.length === 0) {
            document.getElementById("products-section").classList.add("hidden");
          } else {
            document
              .getElementById("products-section")
              .classList.remove("hidden");
          }

          // Hide gallery section if no gallery images
          if (!data.galleryImages || data.galleryImages.length === 0) {
            document.getElementById("gallery-section").classList.add("hidden");
          } else {
            document
              .getElementById("gallery-section")
              .classList.remove("hidden");
          }

          // Hide blog section if no blog posts
          if (!data.blogPosts || data.blogPosts.length === 0) {
            document.getElementById("blog-section").classList.add("hidden");
          } else {
            document.getElementById("blog-section").classList.remove("hidden");
          }

          // Hide FAQ section if no FAQs
          if (!data.faqs || data.faqs.length === 0) {
            document.getElementById("faq-section").classList.add("hidden");
          } else {
            document.getElementById("faq-section").classList.remove("hidden");
          }

          // Hide contact info section if no contact info
          if (!data.contactInfo || data.contactInfo.length === 0) {
            document.getElementById("info-section").classList.add("hidden");
          } else {
            document.getElementById("info-section").classList.remove("hidden");
          }

          // Hide contact form section if disabled
          if (!data.showContactForm) {
            document.getElementById("contact-section").classList.add("hidden");
          } else {
            document
              .getElementById("contact-section")
              .classList.remove("hidden");
          }

          // Hide custom code section if no custom code
          if (!data.customCode || data.customCode.trim() === "") {
            document
              .getElementById("custom-code-section")
              .classList.add("hidden");
          } else {
            document
              .getElementById("custom-code-section")
              .classList.remove("hidden");
          }

          // Hide links container if no links
          if (!data.links || data.links.length === 0) {
            document.getElementById("links-container").classList.add("hidden");
          } else {
            document
              .getElementById("links-container")
              .classList.remove("hidden");
          }

          // Hide blocks section if no blocks
          if (!data.blocks || data.blocks.length === 0) {
            document.getElementById("blocks-container").classList.add("hidden");
          } else {
            document
              .getElementById("blocks-container")
              .classList.remove("hidden");
          }

          // Mark data as loaded
          isDataLoaded = true;

          // Check if images are loaded after a short delay
          setTimeout(() => {
            checkImagesLoaded();
          }, 100);
        } catch (error) {
          console.error("Error fetching profile data:", error);
          // Even on error, mark as loaded to prevent infinite loading
          isDataLoaded = true;
          checkImagesLoaded();
        }
      }

      // Load social links
      function loadSocialLinks(links) {
        const linksContainer = document.getElementById("links-container");
        linksContainer.innerHTML = "";

        if (links.length > 0) {
          links.forEach((link) => {
            const socialLink = document.createElement("a");
            socialLink.href = link.url;
            socialLink.className = "social-link";
            socialLink.target = "_blank";
            socialLink.rel = "noopener noreferrer";

            const icon = document.createElement("i");
            icon.className = `fab fa-${link.icon}`;

            const text = document.createTextNode(link.text);

            socialLink.appendChild(icon);
            socialLink.appendChild(text);
            linksContainer.appendChild(socialLink);
          });
        }
      }

      // Load services
      function loadServices(services) {
        const servicesGrid = document.getElementById("services-grid");
        servicesGrid.innerHTML = "";

        if (services.length > 0) {
          services.forEach((service) => {
            const serviceCard = document.createElement("div");
            serviceCard.className = "service-card";

            const serviceIcon = document.createElement("div");
            serviceIcon.className = "service-icon";
            serviceIcon.innerHTML = `<i class="fas fa-${service.icon}"></i>`;

            const serviceTitle = document.createElement("h3");
            serviceTitle.className = "service-title";
            serviceTitle.textContent = service.title;

            const serviceDescription = document.createElement("p");
            serviceDescription.className = "service-description";
            serviceDescription.textContent = service.description;

            serviceCard.appendChild(serviceIcon);
            serviceCard.appendChild(serviceTitle);
            serviceCard.appendChild(serviceDescription);

            servicesGrid.appendChild(serviceCard);
          });
        }
      }

      // Load products - NEW
      function loadProducts(products) {
        const productsGrid = document.getElementById("products-grid");
        productsGrid.innerHTML = "";

        if (products.length > 0) {
          products.forEach((product) => {
            const productCard = document.createElement("div");
            productCard.className = "product-card";

            // Image or Icon
            if (product.image) {
              const imageContainer = document.createElement("div");
              imageContainer.className = "product-image-container";

              const img = document.createElement("img");
              img.src = product.image;
              img.alt = product.title;
              img.className = "product-image";

              imageContainer.appendChild(img);
              productCard.appendChild(imageContainer);
            } else if (product.icon) {
              const iconContainer = document.createElement("div");
              iconContainer.className = "product-icon-container";

              const icon = document.createElement("i");
              icon.className = `fas fa-${product.icon} product-icon`;

              iconContainer.appendChild(icon);
              productCard.appendChild(iconContainer);
            }

            const productContent = document.createElement("div");
            productContent.className = "product-content";

            const productTitle = document.createElement("h3");
            productTitle.className = "product-title";
            productTitle.textContent = product.title;

            const productDescription = document.createElement("p");
            productDescription.className = "product-description";
            productDescription.textContent = product.description;

            const productPrice = document.createElement("div");
            productPrice.className = "product-price";
            productPrice.textContent = product.price;

            productContent.appendChild(productTitle);
            productContent.appendChild(productDescription);
            productContent.appendChild(productPrice);

            // Optional link button
            if (product.url) {
              const productLink = document.createElement("a");
              productLink.href = product.url;
              productLink.className = "product-link";
              productLink.target = "_blank";
              productLink.rel = "noopener noreferrer";
              productLink.textContent = product.buttonText || "Learn More";

              productContent.appendChild(productLink);
            }

            productCard.appendChild(productContent);
            productsGrid.appendChild(productCard);
          });
        }
      }

      // Load gallery images
      function loadGalleryImages(images) {
        const gallery = document.getElementById("gallery");
        gallery.innerHTML = "";

        if (images.length > 0) {
          images.forEach((image, index) => {
            const galleryItem = document.createElement("div");
            galleryItem.className = "gallery-item";
            galleryItem.addEventListener("click", () => openModal(index));

            const img = document.createElement("img");
            img.src = image;
            img.alt = `Gallery Image ${index + 1}`;
            img.className = "gallery-image";

            galleryItem.appendChild(img);
            gallery.appendChild(galleryItem);
          });
        }
      }

      // Load blog posts - NEW
      function loadBlogPosts(posts) {
        const blogGrid = document.getElementById("blog-grid");
        blogGrid.innerHTML = "";

        if (posts.length > 0) {
          posts.forEach((post, index) => {
            const blogCard = document.createElement("div");
            blogCard.className = "blog-card";

            if (post.image) {
              const imageContainer = document.createElement("div");
              imageContainer.className = "blog-image-container";

              const img = document.createElement("img");
              img.src = post.image;
              img.alt = post.title;
              img.className = "blog-image";

              imageContainer.appendChild(img);
              blogCard.appendChild(imageContainer);
            }

            const blogContent = document.createElement("div");
            blogContent.className = "blog-content";

            const blogDate = document.createElement("div");
            blogDate.className = "blog-date";
            blogDate.textContent = post.date;

            const blogTitle = document.createElement("h3");
            blogTitle.className = "blog-title";
            blogTitle.textContent = post.title;

            const blogExcerpt = document.createElement("p");
            blogExcerpt.className = "blog-excerpt";
            blogExcerpt.textContent =
              post.excerpt || post.content.substring(0, 150) + "...";

            const blogReadMore = document.createElement("a");
            blogReadMore.href = "javascript:void(0)";
            blogReadMore.className = "blog-read-more";
            blogReadMore.textContent = "Read More ";
            blogReadMore.innerHTML += '<i class="fas fa-arrow-right"></i>';
            blogReadMore.addEventListener("click", () => openBlogPost(index));

            blogContent.appendChild(blogDate);
            blogContent.appendChild(blogTitle);
            blogContent.appendChild(blogExcerpt);
            blogContent.appendChild(blogReadMore);

            blogCard.appendChild(blogContent);
            blogGrid.appendChild(blogCard);
          });
        }
      }

      // Open blog post modal - NEW
      function openBlogPost(postIndex) {
        if (blogPosts.length === 0 || postIndex >= blogPosts.length) return;

        const post = blogPosts[postIndex];
        const modal = document.getElementById("blog-post-modal");
        const title = document.getElementById("blog-post-modal-title");
        const date = document.getElementById("blog-post-modal-date");
        const image = document.getElementById("blog-post-modal-image");
        const body = document.getElementById("blog-post-modal-body");

        title.textContent = post.title;
        date.textContent = post.date;

        if (post.image) {
          image.src = post.image;
          image.alt = post.title;
          image.style.display = "block";
        } else {
          image.style.display = "none";
        }

        // Convert content to paragraphs
        body.innerHTML = "";
        const paragraphs = post.content.split("\n\n");
        paragraphs.forEach((paragraph) => {
          if (paragraph.trim()) {
            const p = document.createElement("p");
            p.textContent = paragraph;
            body.appendChild(p);
          }
        });

        modal.classList.add("active");
        document.body.style.overflow = "hidden";
      }

      // Close blog post modal - NEW
      document
        .getElementById("blog-post-modal-close")
        .addEventListener("click", () => {
          document.getElementById("blog-post-modal").classList.remove("active");
          document.body.style.overflow = "auto";
        });

      // Close blog post modal when clicking outside - NEW
      document
        .getElementById("blog-post-modal")
        .addEventListener("click", (e) => {
          if (e.target === document.getElementById("blog-post-modal")) {
            document
              .getElementById("blog-post-modal")
              .classList.remove("active");
            document.body.style.overflow = "auto";
          }
        });

      // Enhanced Professional loadBlocks function
      function loadBlocks(blocks) {
        const container = document.getElementById("blocks-container");

        // Clear existing content
        while (container.firstChild) {
          container.removeChild(container.firstChild);
        }

        if (!blocks || blocks.length === 0) {
          return;
        }

        blocks.forEach((block, index) => {
          const section = document.createElement("div");
          section.className = "block-section";

          // Apply padding
          const padding = block.padding || "normal";
          section.classList.add(`block-padding-${padding}`);

          // Apply color scheme
          applyBlockColorScheme(section, block);

          // Apply animation
          const animation = block.animation || "none";
          if (animation !== "none") {
            section.classList.add("block-animate", `block-${animation}`);
          }

          // Create container
          const blockContainer = document.createElement("div");
          blockContainer.className = "block-container";

          // Create layout based on type
          const layout = block.layout || "two-column";
          const layoutElement = createBlockLayout(block, layout);

          blockContainer.appendChild(layoutElement);
          section.appendChild(blockContainer);
          container.appendChild(section);
        });

        // Initialize animations
        initBlockAnimations();
      }

      function applyBlockColorScheme(section, block) {
        const colorScheme = block.colorScheme || "auto";

        if (colorScheme === "custom") {
          section.style.backgroundColor = block.bgColor || "#ffffff";
          section.style.color = block.textColor || "#333333";
        } else if (colorScheme !== "auto") {
          section.classList.add(`block-scheme-${colorScheme}`);
        } else {
          // Use profile colors
          section.style.backgroundColor = block.bgColor || "var(--bg-color)";
          section.style.color = block.textColor || "var(--text-color)";
        }
      }

      function createBlockLayout(block, layout) {
        const wrapper = document.createElement("div");

        switch (layout) {
          case "two-column":
            wrapper.className = `block-two-column image-${
              block.imagePosition || "right"
            }`;
            wrapper.appendChild(createBlockContent(block));
            if (block.image) {
              wrapper.appendChild(createBlockImage(block));
            }
            break;

          case "centered":
            wrapper.className = "block-centered";
            wrapper.appendChild(createBlockContent(block, true));
            if (block.image) {
              wrapper.appendChild(createBlockImage(block));
            }
            break;

          case "hero":
            wrapper.className = "block-hero";
            if (block.image) {
              wrapper.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url(${block.image})`;
            }
            wrapper.appendChild(createBlockContent(block, true));
            break;

          case "card-grid":
            wrapper.className = "block-card-grid";
            const card = document.createElement("div");
            card.className = "block-card";
            card.appendChild(createBlockContent(block, true));
            if (block.image) {
              card.appendChild(createBlockImage(block));
            }
            wrapper.appendChild(card);
            break;

          case "feature-highlight":
            wrapper.className = "block-feature-highlight";
            wrapper.appendChild(createBlockContent(block, true));
            if (block.image) {
              wrapper.appendChild(createBlockImage(block));
            }
            break;

          default:
            wrapper.className = `block-two-column image-${
              block.imagePosition || "right"
            }`;
            wrapper.appendChild(createBlockContent(block));
            if (block.image) {
              wrapper.appendChild(createBlockImage(block));
            }
        }

        return wrapper;
      }

      function createBlockContent(block, centered = false) {
        const content = document.createElement("div");
        content.className = "block-content-area";

        // Subtitle (optional)
        if (block.subtitle) {
          const subtitle = document.createElement("div");
          subtitle.className = "block-subtitle";
          subtitle.textContent = block.subtitle;
          content.appendChild(subtitle);
        }

        // Title
        if (block.title) {
          const title = document.createElement("h2");
          title.className = "block-title";
          title.textContent = block.title;
          content.appendChild(title);
        }

        // Description
        if (block.text) {
          const description = document.createElement("p");
          description.className = "block-description";
          description.textContent = block.text;
          content.appendChild(description);
        }

        // Button
        if (block.buttonText && block.buttonUrl) {
          const button = document.createElement("a");
          button.href = block.buttonUrl;
          button.className = `block-button block-button-${
            block.buttonStyle || "primary"
          }`;
          button.textContent = block.buttonText;
          button.target = "_blank";
          button.rel = "noopener noreferrer";
          content.appendChild(button);
        }

        return content;
      }

      function createBlockImage(block) {
        const imageArea = document.createElement("div");
        imageArea.className = "block-image-area";

        const imageContainer = document.createElement("div");
        imageContainer.className = "block-image-container";

        const img = document.createElement("img");
        img.src = block.image || "/placeholder.svg";
        img.alt = block.title || "Block Image";
        img.className = "block-image";

        imageContainer.appendChild(img);
        imageArea.appendChild(imageContainer);

        return imageArea;
      }

      function initBlockAnimations() {
        const animatedBlocks = document.querySelectorAll(".block-animate");

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                setTimeout(() => {
                  entry.target.classList.add("animate-in");
                }, 200);
              }
            });
          },
          {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px",
          }
        );

        animatedBlocks.forEach((block, index) => {
          // Stagger animations slightly
          setTimeout(() => {
            observer.observe(block);
          }, index * 100);
        });
      }

      // Load contact information
      function loadContactInfo(contactInfo) {
        const infoGrid = document.getElementById("info-grid");
        infoGrid.innerHTML = "";

        if (contactInfo.length > 0) {
          contactInfo.forEach((info) => {
            const infoCard = document.createElement("div");
            infoCard.className = "info-card";

            const infoIcon = document.createElement("div");
            infoIcon.className = "info-icon";
            infoIcon.innerHTML = `<i class="fas fa-${info.icon}"></i>`;

            const infoTitle = document.createElement("h3");
            infoTitle.className = "info-title";
            infoTitle.textContent = info.title;

            const infoContent = document.createElement("p");
            infoContent.className = "info-content";

            if (info.type === "email") {
              const link = document.createElement("a");
              link.href = `mailto:${info.value}`;
              link.textContent = info.value;
              infoContent.appendChild(link);
            } else if (info.type === "phone") {
              const link = document.createElement("a");
              link.href = `tel:${info.value}`;
              link.textContent = info.value;
              infoContent.appendChild(link);
            } else if (info.type === "link") {
              const link = document.createElement("a");
              link.href = info.value;
              link.textContent = info.value;
              link.target = "_blank";
              link.rel = "noopener noreferrer";
              infoContent.appendChild(link);
            } else {
              infoContent.textContent = info.value;
            }

            infoCard.appendChild(infoIcon);
            infoCard.appendChild(infoTitle);
            infoCard.appendChild(infoContent);

            infoGrid.appendChild(infoCard);
          });
        }
      }

      // Load FAQs
      function loadFaqs(faqs) {
        const faqContainer = document.getElementById("faq-container");
        faqContainer.innerHTML = "";

        if (faqs.length > 0) {
          faqs.forEach((faq, index) => {
            const faqItem = document.createElement("div");
            faqItem.className = "faq-item";
            faqItem.id = `faq-${index}`;

            const faqQuestion = document.createElement("div");
            faqQuestion.className = "faq-question";
            faqQuestion.innerHTML = `
              <span>${faq.question}</span>
              <i class="fas fa-chevron-down"></i>
          `;

            const faqAnswer = document.createElement("div");
            faqAnswer.className = "faq-answer";

            const faqAnswerContent = document.createElement("div");
            faqAnswerContent.className = "faq-answer-content";
            faqAnswerContent.textContent = faq.answer;

            faqAnswer.appendChild(faqAnswerContent);

            faqItem.appendChild(faqQuestion);
            faqItem.appendChild(faqAnswer);

            faqQuestion.addEventListener("click", () => {
              faqItem.classList.toggle("active");
            });

            faqContainer.appendChild(faqItem);
          });
        }
      }

      // FIXED: Reorder page sections based on saved order
      function reorderSections(order) {
        const container = document.querySelector("#main-content > .container");
        if (!container) return;

        // Get the header and links container first
        const header = container.querySelector("header");
        const linksContainer = container.querySelector(".links-container");
        const footer = container.querySelector(".footer");

        // Store all sections and divs in a map for easy access
        const elementsMap = new Map();

        // Get all sections
        const allSections = container.querySelectorAll("section");
        allSections.forEach((section) => {
          elementsMap.set(section.id, section);
        });

        // Also get the blocks-container div (which is now a section)
        const blocksContainer = container.querySelector("#blocks-container");
        if (blocksContainer) {
          elementsMap.set("blocks-container", blocksContainer);
        }

        // Clear container but keep header and links
        container.innerHTML = "";
        if (header) container.appendChild(header);
        if (linksContainer) container.appendChild(linksContainer);

        // Parse the order string if it's a string
        let sectionOrder = order;
        if (typeof order === "string") {
          sectionOrder = order
            .split(",")
            .map((id) => id.trim())
            .filter((id) => id);
        }

        // Add sections in the specified order
        sectionOrder.forEach((id) => {
          const element = elementsMap.get(id);
          if (element) {
            container.appendChild(element);
          }
        });

        // Add any remaining sections that weren't in the order
        elementsMap.forEach((element, id) => {
          if (!sectionOrder.includes(id) && !container.contains(element)) {
            container.appendChild(element);
          }
        });

        // Add footer at the end
        if (footer) {
          container.appendChild(footer);
        }
      }

      // Confirmation Modal - NEW
      const confirmModal = document.getElementById("confirm-modal");
      const confirmModalTitle = document.getElementById("confirm-modal-title");
      const confirmModalMessage = document.getElementById(
        "confirm-modal-message"
      );
      const confirmModalCancel = document.getElementById(
        "confirm-modal-cancel"
      );
      const confirmModalConfirm = document.getElementById(
        "confirm-modal-confirm"
      );

      // Show confirmation modal
      function showConfirmModal(title, message, onConfirm) {
        confirmModalTitle.textContent = title;
        confirmModalMessage.textContent = message;

        // Reset event listeners
        const newConfirmBtn = confirmModalConfirm.cloneNode(true);
        confirmModalConfirm.parentNode.replaceChild(
          newConfirmBtn,
          confirmModalConfirm
        );

        // Add new event listener
        newConfirmBtn.addEventListener("click", () => {
          onConfirm();
          closeConfirmModal();
        });

        // Show modal
        confirmModal.classList.add("active");
        document.body.style.overflow = "hidden";
      }

      // Close confirmation modal
      function closeConfirmModal() {
        confirmModal.classList.remove("active");
        document.body.style.overflow = "auto";
      }

      // Cancel button click
      confirmModalCancel.addEventListener("click", closeConfirmModal);

      // Close modal when clicking outside
      confirmModal.addEventListener("click", (e) => {
        if (e.target === confirmModal) {
          closeConfirmModal();
        }
      });

      // Enhanced Modal functionality
      const modal = document.getElementById("image-modal");
      const modalImage = document.getElementById("modal-image");
      const modalTitle = document.getElementById("modal-title");
      const modalCounter = document.getElementById("modal-counter");
      const closeModal = document.getElementById("close-modal");
      const prevImage = document.getElementById("prev-image");
      const nextImage = document.getElementById("next-image");

      function openModal(imageIndex) {
        if (galleryImages.length === 0) return;

        currentImageIndex = imageIndex;
        updateModalContent();
        modal.style.display = "flex";
        document.body.style.overflow = "hidden";
      }

      function updateModalContent() {
        if (galleryImages.length === 0) return;

        modalImage.src = galleryImages[currentImageIndex];
        modalTitle.textContent = `Gallery Image ${currentImageIndex + 1}`;
        modalCounter.textContent = `${currentImageIndex + 1} / ${
          galleryImages.length
        }`;

        // Update navigation buttons
        prevImage.disabled = currentImageIndex === 0;
        nextImage.disabled = currentImageIndex === galleryImages.length - 1;

        // Hide navigation if only one image
        if (galleryImages.length <= 1) {
          prevImage.style.display = "none";
          nextImage.style.display = "none";
        } else {
          prevImage.style.display = "flex";
          nextImage.style.display = "flex";
        }
      }

      function closeModalFunction() {
        modal.style.display = "none";
        document.body.style.overflow = "auto";
      }

      function showPrevImage() {
        if (currentImageIndex > 0) {
          currentImageIndex--;
          updateModalContent();
        }
      }

      function showNextImage() {
        if (currentImageIndex < galleryImages.length - 1) {
          currentImageIndex++;
          updateModalContent();
        }
      }

      // Modal event listeners
      closeModal.addEventListener("click", closeModalFunction);
      prevImage.addEventListener("click", showPrevImage);
      nextImage.addEventListener("click", showNextImage);

      // Keyboard navigation
      document.addEventListener("keydown", (e) => {
        if (modal.style.display === "flex") {
          switch (e.key) {
            case "Escape":
              closeModalFunction();
              break;
            case "ArrowLeft":
              showPrevImage();
              break;
            case "ArrowRight":
              showNextImage();
              break;
          }
        }
      });

      // Close modal when clicking outside
      window.addEventListener("click", (event) => {
        if (event.target === modal) {
          closeModalFunction();
        }
      });

      // Touch/swipe support for mobile
      let touchStartX = 0;
      let touchEndX = 0;

      modal.addEventListener("touchstart", (e) => {
        touchStartX = e.changedTouches[0].screenX;
      });

      modal.addEventListener("touchend", (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
      });

      function handleSwipe() {
        const swipeThreshold = 50;
        const diff = touchStartX - touchEndX;

        if (Math.abs(diff) > swipeThreshold) {
          if (diff > 0) {
            // Swipe left - next image
            showNextImage();
          } else {
            // Swipe right - previous image
            showPrevImage();
          }
        }
      }

      // Contact form submission
      const contactForm = document.getElementById("contact-form");
      const submitButton = document.getElementById("submit-button");
      const loadingSpinner = document.getElementById("loading");
      const buttonText = document.getElementById("button-text");
      const successAlert = document.getElementById("success-alert");
      const errorAlert = document.getElementById("error-alert");

      contactForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Reset alerts
        successAlert.style.display = "none";
        errorAlert.style.display = "none";

        // Show loading state
        submitButton.disabled = true;
        loadingSpinner.classList.remove("hidden");
        buttonText.textContent = "Sending...";

        const name = document.getElementById("name").value;
        const email = document.getElementById("email").value;
        const message = document.getElementById("message").value;

        try {
          const response = await fetch("/api/contact", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ name, email, message }),
          });

          if (!response.ok) {
            throw new Error("Failed to send message");
          }

          // Show success message
          successAlert.style.display = "block";

          // Reset form
          contactForm.reset();
        } catch (error) {
          console.error("Error sending message:", error);
          errorAlert.style.display = "block";
        } finally {
          // Reset button state
          submitButton.disabled = false;
          loadingSpinner.classList.add("hidden");
          buttonText.textContent = "Send Message";
        }
      });

      // Initialize when page loads
      document.addEventListener("DOMContentLoaded", () => {
        // Fetch profile data
        fetchProfileData();

        // Fallback: hide loading screen after 8 seconds maximum
        setTimeout(() => {
          if (!isDataLoaded || !isImagesLoaded) {
            isDataLoaded = true;
            isImagesLoaded = true;
            hideLoadingScreen();
          }
        }, 8000);
      });
    </script>
  </body>
</html>
